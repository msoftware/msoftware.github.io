<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_121) on Tue May 22 15:49:13 CEST 2018 -->
<title>MigrationTestHelper</title>
<meta name="date" content="2018-05-22">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="MigrationTestHelper";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?androidx/room/testing/MigrationTestHelper.html" target="_top">Frames</a></li>
<li><a href="MigrationTestHelper.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">androidx.room.testing</div>
<h2 title="Class MigrationTestHelper" class="title">Class MigrationTestHelper</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>TestWatcher</li>
<li>
<ul class="inheritance">
<li>androidx.room.testing.MigrationTestHelper</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">MigrationTestHelper</span>
extends TestWatcher</pre>
<div class="block">A class that can be used in your Instrumentation tests that can create the database in an
 older schema.
 <p>
 You must copy the schema json files (created by passing <code>room.schemaLocation</code> argument
 into the annotation processor) into your test assets and pass in the path for that folder into
 the constructor. This class will read the folder and extract the schemas from there.
 <pre>
 android {
   defaultConfig {
     javaCompileOptions {
       annotationProcessorOptions {
         arguments = ["room.schemaLocation": "$projectDir/schemas".toString()]
       }
     }
   }
   sourceSets {
     androidTest.assets.srcDirs += files("$projectDir/schemas".toString())
   }
 }
 </pre></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../androidx/room/testing/MigrationTestHelper.html#MigrationTestHelper-Instrumentation-java.lang.String-">MigrationTestHelper</a></span>(Instrumentation&nbsp;instrumentation,
                   java.lang.String&nbsp;assetsFolder)</code>
<div class="block">Creates a new migration helper.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../androidx/room/testing/MigrationTestHelper.html#MigrationTestHelper-Instrumentation-java.lang.String-androidx.sqlite.db.SupportSQLiteOpenHelper.Factory-">MigrationTestHelper</a></span>(Instrumentation&nbsp;instrumentation,
                   java.lang.String&nbsp;assetsFolder,
                   <a href="../../../androidx/sqlite/db/SupportSQLiteOpenHelper.Factory.html" title="interface in androidx.sqlite.db">SupportSQLiteOpenHelper.Factory</a>&nbsp;openFactory)</code>
<div class="block">Creates a new migration helper.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../androidx/room/testing/MigrationTestHelper.html#closeWhenFinished-androidx.room.RoomDatabase-">closeWhenFinished</a></span>(<a href="../../../androidx/room/RoomDatabase.html" title="class in androidx.room">RoomDatabase</a>&nbsp;db)</code>
<div class="block">Registers a database connection to be automatically closed when the test finishes.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../androidx/room/testing/MigrationTestHelper.html#closeWhenFinished-androidx.sqlite.db.SupportSQLiteDatabase-">closeWhenFinished</a></span>(<a href="../../../androidx/sqlite/db/SupportSQLiteDatabase.html" title="interface in androidx.sqlite.db">SupportSQLiteDatabase</a>&nbsp;db)</code>
<div class="block">Registers a database connection to be automatically closed when the test finishes.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="../../../androidx/sqlite/db/SupportSQLiteDatabase.html" title="interface in androidx.sqlite.db">SupportSQLiteDatabase</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../androidx/room/testing/MigrationTestHelper.html#createDatabase-java.lang.String-int-">createDatabase</a></span>(java.lang.String&nbsp;name,
              int&nbsp;version)</code>
<div class="block">Creates the database in the given version.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../androidx/room/testing/MigrationTestHelper.html#finished-Description-">finished</a></span>(Description&nbsp;description)</code>&nbsp;</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code><a href="../../../androidx/sqlite/db/SupportSQLiteDatabase.html" title="interface in androidx.sqlite.db">SupportSQLiteDatabase</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../androidx/room/testing/MigrationTestHelper.html#runMigrationsAndValidate-java.lang.String-int-boolean-androidx.room.migration.Migration...-">runMigrationsAndValidate</a></span>(java.lang.String&nbsp;name,
                        int&nbsp;version,
                        boolean&nbsp;validateDroppedTables,
                        <a href="../../../androidx/room/migration/Migration.html" title="class in androidx.room.migration">Migration</a>...&nbsp;migrations)</code>
<div class="block">Runs the given set of migrations on the provided database.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../androidx/room/testing/MigrationTestHelper.html#starting-Description-">starting</a></span>(Description&nbsp;description)</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="MigrationTestHelper-Instrumentation-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MigrationTestHelper</h4>
<pre>public&nbsp;MigrationTestHelper(Instrumentation&nbsp;instrumentation,
                           java.lang.String&nbsp;assetsFolder)</pre>
<div class="block">Creates a new migration helper. It uses the Instrumentation context to load the schema
 (falls back to the app resources) and the target context to create the database.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>instrumentation</code> - The instrumentation instance.</dd>
<dd><code>assetsFolder</code> - The asset folder in the assets directory.</dd>
</dl>
</li>
</ul>
<a name="MigrationTestHelper-Instrumentation-java.lang.String-androidx.sqlite.db.SupportSQLiteOpenHelper.Factory-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>MigrationTestHelper</h4>
<pre>public&nbsp;MigrationTestHelper(Instrumentation&nbsp;instrumentation,
                           java.lang.String&nbsp;assetsFolder,
                           <a href="../../../androidx/sqlite/db/SupportSQLiteOpenHelper.Factory.html" title="interface in androidx.sqlite.db">SupportSQLiteOpenHelper.Factory</a>&nbsp;openFactory)</pre>
<div class="block">Creates a new migration helper. It uses the Instrumentation context to load the schema
 (falls back to the app resources) and the target context to create the database.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>instrumentation</code> - The instrumentation instance.</dd>
<dd><code>assetsFolder</code> - The asset folder in the assets directory.</dd>
<dd><code>openFactory</code> - Factory class that allows creation of <a href="../../../androidx/sqlite/db/SupportSQLiteOpenHelper.html" title="interface in androidx.sqlite.db"><code>SupportSQLiteOpenHelper</code></a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="starting-Description-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>starting</h4>
<pre>protected&nbsp;void&nbsp;starting(Description&nbsp;description)</pre>
</li>
</ul>
<a name="createDatabase-java.lang.String-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createDatabase</h4>
<pre>public&nbsp;<a href="../../../androidx/sqlite/db/SupportSQLiteDatabase.html" title="interface in androidx.sqlite.db">SupportSQLiteDatabase</a>&nbsp;createDatabase(java.lang.String&nbsp;name,
                                            int&nbsp;version)
                                     throws java.io.IOException</pre>
<div class="block">Creates the database in the given version.
 If the database file already exists, it tries to delete it first. If delete fails, throws
 an exception.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>name</code> - The name of the database.</dd>
<dd><code>version</code> - The version in which the database should be created.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A database connection which has the schema in the requested version.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - If it cannot find the schema description in the assets folder.</dd>
</dl>
</li>
</ul>
<a name="runMigrationsAndValidate-java.lang.String-int-boolean-androidx.room.migration.Migration...-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>runMigrationsAndValidate</h4>
<pre>public&nbsp;<a href="../../../androidx/sqlite/db/SupportSQLiteDatabase.html" title="interface in androidx.sqlite.db">SupportSQLiteDatabase</a>&nbsp;runMigrationsAndValidate(java.lang.String&nbsp;name,
                                                      int&nbsp;version,
                                                      boolean&nbsp;validateDroppedTables,
                                                      <a href="../../../androidx/room/migration/Migration.html" title="class in androidx.room.migration">Migration</a>...&nbsp;migrations)
                                               throws java.io.IOException</pre>
<div class="block">Runs the given set of migrations on the provided database.
 <p>
 It uses the same algorithm that Room uses to choose migrations so the migrations instances
 that are provided to this method must be sufficient to bring the database from current
 version to the desired version.
 <p>
 After the migration, the method validates the database schema to ensure that migration
 result matches the expected schema. Handling of dropped tables depends on the
 <code>validateDroppedTables</code> argument. If set to true, the verification will fail if it
 finds a table that is not registered in the Database. If set to false, extra tables in the
 database will be ignored (this is the runtime library behavior).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>name</code> - The database name. You must first create this database via
                              <a href="../../../androidx/room/testing/MigrationTestHelper.html#createDatabase-java.lang.String-int-"><code>createDatabase(String, int)</code></a>.</dd>
<dd><code>version</code> - The final version after applying the migrations.</dd>
<dd><code>validateDroppedTables</code> - If set to true, validation will fail if the database has
                              unknown
                              tables.</dd>
<dd><code>migrations</code> - The list of available migrations.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - If it cannot find the schema for <code>toVersion</code>.</dd>
<dd><code>java.lang.IllegalStateException</code> - If the schema validation fails.</dd>
</dl>
</li>
</ul>
<a name="finished-Description-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>finished</h4>
<pre>protected&nbsp;void&nbsp;finished(Description&nbsp;description)</pre>
</li>
</ul>
<a name="closeWhenFinished-androidx.sqlite.db.SupportSQLiteDatabase-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>closeWhenFinished</h4>
<pre>public&nbsp;void&nbsp;closeWhenFinished(<a href="../../../androidx/sqlite/db/SupportSQLiteDatabase.html" title="interface in androidx.sqlite.db">SupportSQLiteDatabase</a>&nbsp;db)</pre>
<div class="block">Registers a database connection to be automatically closed when the test finishes.
 <p>
 This only works if <code>MigrationTestHelper</code> is registered as a Junit test rule via
 <code>Rule</code> annotation.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>db</code> - The database connection that should be closed after the test finishes.</dd>
</dl>
</li>
</ul>
<a name="closeWhenFinished-androidx.room.RoomDatabase-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>closeWhenFinished</h4>
<pre>public&nbsp;void&nbsp;closeWhenFinished(<a href="../../../androidx/room/RoomDatabase.html" title="class in androidx.room">RoomDatabase</a>&nbsp;db)</pre>
<div class="block">Registers a database connection to be automatically closed when the test finishes.
 <p>
 This only works if <code>MigrationTestHelper</code> is registered as a Junit test rule via
 <code>Rule</code> annotation.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>db</code> - The RoomDatabase instance which holds the database.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li>Next&nbsp;Class</li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?androidx/room/testing/MigrationTestHelper.html" target="_top">Frames</a></li>
<li><a href="MigrationTestHelper.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Generated javadoc for the new package structure to make it clearer which packages are bundled with the Android operating system, and which are packaged with your app's APK. Going forward, the android.* package hierarchy will be reserved for Android packages that ship with the operating system; other packages will be issued in the new <a htef='http://androidx.de/'>androidx</a>.* package hiearchy.</small></p>
</body>
</html>
